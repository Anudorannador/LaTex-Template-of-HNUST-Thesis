\documentclass[a4paper,12pt,twoside]{book} % A4纸，小四号大小就是12pt
\usepackage[utf8]{inputenc}
\usepackage{graphicx}

% 字体相关设置
\usepackage[AutoFakeBold=true]{xeCJK} %使用CJK包以便使用中文
\usepackage{CJKnumb}
\usepackage{xunicode}
\usepackage{fontspec}
\setmainfont{Times New Roman}
\setCJKmainfont{SimSun}
\setCJKfamilyfont{Heiti}{SimHei}

% 行距 1.25
% word 中的行距跟latex中的行距概念不一样。
% word 中，行距 = 单倍行距 x 行距值(1.25)，而单倍行距 = 字体大小 x 固定系数(1.297/1.30)
% 默认字体12pt，所以 word 中行距 = 单倍行距 x 1.25 = 12pt x 1.3 x 1.25 = 19.5 pt
% latex 中，默认字体大小 12pt，可以通过设置其 baselineskip = 19.455 pt 来达到word要求的1.25倍行距的效果
% 又因为latex中默认 baselineskip = fontsize x 1.2，所以默认 baselineskip = 12pt x 1.2 = 14.4 pt
% 所以要求的 baselineskip 是默认的 baselineskip 的 19.455/14.4pt = 1.352 倍：
\linespread{1.354}

% 字体大小
	% \fontsize{fontsize}{baselineskip}\selectfont
\newcommand{\chuhao}{\fontsize{42pt}{50.4pt}\selectfont} % 初号字体 42pt
\newcommand{\xiaochu}{\fontsize{36pt}{43.2pt}\selectfont} % 小初字体 36pt
\newcommand{\yihao}{\fontsize{26pt}{31.2pt}\selectfont} % 一号字体 26pt
\newcommand{\xiaoyi}{\fontsize{24pt}{28.8pt}\selectfont} % 小一字体 24pt
\newcommand{\erhao}{\fontsize{22pt}{26.4pt}\selectfont} % 二号字体 22pt
\newcommand{\xiaoer}{\fontsize{18pt}{21.6pt}\selectfont} % 小二字体 18pt
\newcommand{\sanhao}{\fontsize{16pt}{19.2pt}\selectfont} % 三号字体 16pt
\newcommand{\xiaosan}{\fontsize{15pt}{18pt}\selectfont} % 小三字体 15pt
\newcommand{\sihao}{\fontsize{14pt}{16.8pt}\selectfont} % 四号字体 14pt
\newcommand{\xiaosi}{\fontsize{12pt}{14.4pt}\selectfont} % 小四字体 12pt
\newcommand{\wuhao}{\fontsize{10.5pt}{12.6pt}\selectfont} % 五号字体 10.5pt
\newcommand{\xiaowu}{\fontsize{9pt}{10.8pt}\selectfont} % 小五字体 9pt
\newcommand{\liuhao}{\fontsize{7.5pt}{9pt}\selectfont} % 六号字体 7.5pt
\newcommand{\xiaoliu}{\fontsize{6.5pt}{7.8pt}\selectfont} % 小六字体 6.5pt
\newcommand{\qihao}{\fontsize{5.5pt}{6.6pt}\selectfont} % 七号字体 5.5pt
\newcommand{\bahao}{\fontsize{5pt}{6pt}\selectfont} % 八号字体 5pt

% 页面设置
\usepackage[headheight=2cm,marginparwidth=0pt,headsep=1cm,foot=1cm,marginparsep=0pt]{geometry} % 设置页眉高度2cm,页脚高度其实没卵用的，除了上边距+页眉高度+正文体高度，其他都是页脚
\geometry{left=2.5cm,right=2.5cm,top=3cm,bottom=2.5cm} % 设置左、右、下边距为25mm，上边距30mm

% 页眉和页脚设置
\usepackage{fancyhdr} % 需要使用的包
\fancypagestyle{plain}{% 重定义 plain style，这个样式章节中全部用到。
	\fancyhf{}
	\fancyhead[C]{\wuhao 湖南科技大学本科毕业设计(论文)}
	\fancyfoot[C]{-\thepage-}
%	\renewcommand{\headrulewidth}{0pt} % 去掉页眉的线
}

% 章节设置
\usepackage{titlesec}
	% 设置 章 标题
\titlespacing*{\chapter}{0pt}{-11pt}{11pt} % 段前段后各空0.5行
\titleformat{\chapter}[hang]{\centering\xiaoer\bfseries}{第\CJKnumber\thechapter 章\quad}{0pt}{}{}
	% 设置 节 标题
\titlespacing*{\section}{0pt}{14pt}{14pt}% 段前段后各空0.5行
\titleformat{\section}[hang]{\sihao\bfseries}{\thesection\quad}{0pt}{}{}
	% 设置 条 标题
\titlespacing*{\subsection}{0pt}{12pt}{12pt}
\titleformat{\subsection}[hang]{\xiaosi\bfseries}{\thesubsection\quad}{0pt}{}{}

% 使用款、项
\usepackage{enumitem}
	% label=(\arabic*) 款、项序号为 (1), (2)...
	% itemindent=24 一个字12pt，空两格24pt
	% itemsep=-3pt 每两个item的上下间距减小，更紧凑
\setenumerate{label=(\arabic*), itemindent=24pt, itemsep=-3pt}

% 正文设置
\usepackage{indentfirst} % 首行缩进
\setlength\parindent{24pt} % 因为字大小12pt，所以缩进两个字就是24pt
\usepackage{layout}

% 目录设置
\usepackage{titletoc} % 控制目录的宏包
\titlecontents{chapter}[0em]{\sihao\vspace{5.95pt}}{\bfseries 第\CJKnumber\thecontentslabel 章\quad}{}{\wuhao\titlerule*[5pt]{$\cdot$}\contentspage}[\addvspace{2.5pt}] % 目录章样式，四号加粗宋体 titlerule*[Xpt]调整点的密集度，X越小密度越高
\titlecontents{section}[2em]{\xiaosi}{\thecontentslabel\quad}{}{\wuhao\titlerule*[5pt]{$\cdot$}\contentspage} % 目录节样式
\titlecontents{subsection}[4em]{\xiaosi}{\thecontentslabel\quad}{}{\wuhao\titlerule*[5pt]{$\cdot$}\contentspage}
\renewcommand{\contentsname}{\sanhao\CJKfamily{Heiti}\textbf{目 \qquad 录}} % 目录样式

% 脚注设置
\usepackage{tikz}
\newcommand{\footnotenumber}{\fontsize{4pt}{0pt}\selectfont}
\newcommand*\circled[1]{%
	\tikz[baseline=-4pt]\node[shape=circle,draw,inner sep=0.2pt,font=\footnotenumber,minimum size=1pt] (char) {#1};} % baseline=X，X负的绝对值越大，脚注产生的圆圈就越高
\renewcommand\thefootnote{\protect\circled{\arabic{footnote}}}

% 数学相关设置
\usepackage{amsbsy}
\usepackage{amssymb}
\usepackage{amstext}

% 插图编排设置
\usepackage{float} % 能够使用 H 位置
\usepackage{wrapfig} % 能够使用文字环包的图
\usepackage{graphicx}
\usepackage[labelfont=bf,font=bf]{caption}
\usepackage{subcaption} % 子图的标题样式需要这个包
\captionsetup[subfigure]{labelformat=simple, labelsep=none}
\renewcommand{\thesubfigure}{\alph{subfigure})\ } % 子图的标题样式 a) b) c)

% 参考文献
\renewcommand{\bibname}{\sihao 参\quad 考\quad 文\quad 献}
\bibliographystyle{gbt7714-2005} % 使用 GB/T 7714-2005 的标准，GB7714-87在2005年就被废了 感谢提供：https://github.com/Haixing-Hu/GBT7714-2005-BibTeX-Style
\usepackage{url} % 使用在线链接参考文献使用

% 致谢设置
\newcommand{\thanksfor}{\newpage\addcontentsline{toc}{chapter}{\sihao \bfseries 致\qquad 谢}\chapter*{致\qquad 谢}}

% 附录设置
\newcounter{appnum}
\setcounter{appnum}{0}
\renewcommand{\theappnum}{\Alph{appnum}}
\newcommand{\NewAppend}{\refstepcounter{appnum}\newpage\addcontentsline{toc}{chapter}{\sihao \bfseries 附\quad 录 \Alph{appnum}}\chapter*{附\quad 录 \Alph{appnum}}}

% 图表label设置
\usepackage{multirow} % 多行列表
\renewcommand{\figurename}{图}
\renewcommand{\tablename}{表}

\usepackage{pdfpages} % 将扉页、任务书等PDF进行导入需要用到此包

\usepackage{listings} % 插入代码需要

\begin{document}

\author{author}
\title{title}
\date{2016年上半年}

\frontmatter
\includepdf[pages={1-}]{../docs/frontpages.pdf} % 将扉页、任务书等PDF导入，如果不需要，可以注释这行。
%\maketitle

% 设置摘要，因为 class 是 book，所以没有 Abstruct 环境，而且字体大小跟chapter一样，所以用 chapter* 来代替
\newcommand{\NewAbstract}[1]{\chapter*{#1}\thispagestyle{empty}}
\newpage
\pagestyle{empty}
\include{./texs/Abstract_Chinese} % 请转到该文档中填写中文摘要
\cleardoublepage
\include{./texs/Abstract_English} % 请转到该文档中填写英文摘要
\cleardoublepage

\newpage
\setcounter{page}{1}
\pagestyle{plain} % 目录开始使用统一的页面样式

% 插入目录
\tableofcontents
\cleardoublepage

\mainmatter
\newpage

% 以下是各个章：
% 每章可自定义名称，然后包含进来
\include{./texs/example}

\backmatter
% bibliography, glossary and index would go here.

% 参考文献
\newpage
\addcontentsline{toc}{chapter}{\sihao \bfseries 参考文献} % 把参考文献加入目录
{\wuhao \bibliography{bibfile}} % 请在 bibfile.bbl 中写好文献 % 要求用5号字体

% 致谢
% 致谢请用 \thanksfor
\include{./texs/thanksfor}

% 附录
% 附录请用 \NewAppend
\appendix
\include{./texs/appendix_eg}

\end{document}
